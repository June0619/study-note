# Week 4 (2023-07-24 ~ 2023-07-30)

## Spring MVC2 - Login
### 세션
- 로그인 시도 성공 시 서버에 세션 ID와 회원 정보를 저장한다.
- 이때 세션 ID 는 사용자가 유추 불가능한 문자열 (UUID 등) 을 사용한다.
- 사용자는 세션 ID 값만 쿠키로 저장한다. (사용자 정보를 전혀 전달받지 않음)
- 서버 측에서는 해당 세션을 30분 후 제거한다.

### HttpServlet Session
- static 한 String 등을 관리 할 때에는 new 연산자로 객체가 만들어지지 않도록 추상클래스나 인터페이스를 이용한다.
- `getSession(boolean)` 
    - `true` :요청 시 세션이 없으면 생성
    - `false` : 요청 시 세션이 없으면 null 반환

- REST API 통신에서도 위와 마찬가지로 Cookie 헤더를 통해 Session ID 를 전달할 수 있다.

- Spring에서는 `@SessionAttribute` 애노테이션을 통해 손쉽게 세션 체크 및 객체를 꺼낼 수 있다.
    - 참고로 해당 기능은 없는 세션을 생성해주지는 않는다.

- TrackingModes
    - 쿠키를 지원하지 않는 웹 브라우저를 위해 URL 에 세션 정보를 함께 전달하는 방식
    - 잘 사용되지는 않는다.

### 세션 타임아웃
- 세션은 메모리 상 비용을 차지하기 때문에 시간을 체크해서 만료시켜줘야 한다.
- `HttpSession` 객체는 사용자의 마지막 활동으로부터 (기본값) 30분 후 만료시킨다.
- 세션에 저장할 객체는 최소한의 정보만 유지시켜 주어야 한다.

## Spring MVC2 - Filter, Interceptor
- 모든 비지니스 로직에서 공통으로 체크해야 하는(ex: 로그인 여부) 등을 '공통 관심사' 라고 한다.
- 이러한 공통 관심사를 지원하는 기능은 '서블릿 필터', 스프링 인터셉터, 스프링 AOP 등이 있다.
- 이 중 웹과 관련된 정보 (HTTP 관련 정보가 포함되는) 를 처리할때는 필터나 인터셉터를 사용하는 것이 좋다.

### Servlet Filter
- 서블릿이 지원하는 수문장이다.

> ❗ 필터의 흐름 </br>
> HTTP 요청 -> WAS -> 필터 -> 서블릿 -> 컨트롤러 </br></br>
> ❗ 필터 체인 </br>
> HTTP 요청 -> WAS -> 필터1 -> 필터2 -> 필터3 -> 서블릿 -> 컨트롤러

- 필터 인터페이스 구현 후 등록하면, 서블릿 컨테이너가 싱글톤 객체로 관리한다.

